document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("markdown-input"),t=document.getElementById("html-preview"),n=document.getElementById("html-code"),d=document.getElementById("remove-emojis"),a=document.getElementById("add-heading-ids"),o=document.getElementById("add-rel-to-links"),s=document.getElementById("sanitize-html"),l=document.getElementById("escape-html-chars"),c=document.getElementById("drop-area"),r=document.getElementById("file-upload"),i=document.getElementById("copy-html"),m=document.getElementById("download-html"),u=document.getElementById("sidebar"),g=document.getElementById("menu-button"),h=document.getElementById("sidebar-overlay"),y=document.getElementById("css-input"),p=document.getElementById("tools-dropdown"),E=document.getElementById("tools-dropdown-menu"),v=document.getElementById("mobile-tools-button"),L=document.getElementById("mobile-tools-menu"),f=document.getElementById("mobile-tools-arrow"),b=()=>{u.classList.toggle("-translate-x-full"),h.classList.toggle("hidden")};let k;if(g&&g.addEventListener("click",b),h&&h.addEventListener("click",b),p&&E){const e=()=>{clearTimeout(k),E.classList.remove("hidden")},t=()=>{k=setTimeout(()=>{E.classList.add("hidden")},200)};p.addEventListener("mouseenter",e),p.addEventListener("mouseleave",t)}v&&L&&f&&v.addEventListener("click",()=>{L.classList.toggle("hidden"),f.classList.toggle("rotate-180")});const w=new marked.Renderer;w.heading=(e,t,n)=>{const d=e.text,o=e.depth;let s=d.toLowerCase().trim().replace(/[^\p{L}\p{N}]+/gu,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,"");return s||(s=`section-${Math.random().toString(36).substring(2,9)}`),a.checked?`<h${o} id="${s}">${d}</h${o}>\n`:`<h${o}>${d}</h${o}>\n`},w.link=(e,t,n)=>{const d=e.href,a=e.title,s=e.text;let l=`<a href="${d}"`;return a&&(l+=` title="${a}"`),o.checked&&(l+=' rel="noopener noreferrer"'),l+=`>${s}</a>`,l};const x=new marked.Marked({renderer:w,pedantic:!1,gfm:!0,breaks:!0,sanitize:!1,smartLists:!0,smartypants:!1,xhtml:!1});let B="";const I=()=>{let a=e.value||"";a=a.replace(/^\s*â€¢/gm,"-").replace(/^\s*:/gm,"-"),d.checked&&(a=a.replace(/\u00a9|\u00ae|[\u2000-\u3300]|\ud83c[\ud000-\udfff]|\ud83d[\ud000-\udfff]|\ud83e[\ud000-\udfff]/g,"")),l.checked&&(a=a.replace(/</g,"&lt;").replace(/>/g,"&gt;"));let o=x.parse(a);s.checked&&(o=DOMPurify.sanitize(o)),n.textContent=o;const c=y.value;B=`<!DOCTYPE html>\n<html lang="en">\n<head>\n  <meta charset="UTF-8">\n  <title>HTML Preview</title>\n  <link rel="stylesheet" href="style.css?v5">\n  <style>\n    body { padding: 1.5rem; } /* Add some padding to the iframe body */\n    ${c}\n  </style>\n</head>\n<body class="prose max-w-none">\n  ${o}\n</body>\n</html>`;const r=t.contentDocument||t.contentWindow.document;r.open(),r.write(B),r.close()};e.addEventListener("input",I),d.addEventListener("change",I),a.addEventListener("change",I),o.addEventListener("change",I),s.addEventListener("change",I),l.addEventListener("change",I),m.addEventListener("click",()=>{const e=new Blob([B],{type:"text/html"}),t=document.createElement("a");t.href=URL.createObjectURL(e),t.download="markdown-export.html",document.body.appendChild(t),t.click(),document.body.removeChild(t)}),y.addEventListener("input",I);const q=t=>{const n=t[0];if(n&&n.name.endsWith(".md")){const t=new FileReader;t.onload=t=>{e.value=t.target.result,I(),document.querySelector('#input-tabs button[data-tab="markdown"]').click()},t.readAsText(n)}};c.addEventListener("dragenter",e=>{e.preventDefault(),c.classList.add("bg-gray-200")}),c.addEventListener("dragover",e=>{e.preventDefault()}),c.addEventListener("dragleave",()=>{c.classList.remove("bg-gray-200")}),c.addEventListener("drop",e=>{e.preventDefault(),c.classList.remove("bg-gray-200"),q(e.dataTransfer.files)}),c.addEventListener("click",()=>r.click()),r.addEventListener("change",e=>{q(e.target.files)}),i.addEventListener("click",()=>{navigator.clipboard.writeText(n.textContent).then(()=>{Toastify({text:"HTML code copied!",duration:3e3,gravity:"bottom",position:"center",style:{background:"#4f46e5"}}).showToast()},()=>{Toastify({text:"Failed to copy.",duration:3e3,gravity:"bottom",position:"center",style:{background:"#ef4444"}}).showToast()})}),n.addEventListener("keydown",e=>{if((e.ctrlKey||e.metaKey)&&"a"===e.key){e.preventDefault();const t=document.createRange();t.selectNodeContents(n);const d=window.getSelection();d.removeAllRanges(),d.addRange(t)}});const S=e=>{const t=document.getElementById(e),n=t.querySelectorAll(".tab-btn"),d=t.parentElement.nextElementSibling;n.forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.tab;n.forEach(e=>{e.classList.remove("tab-active","text-indigo-600"),e.classList.add("tab-inactive","text-gray-500")}),e.classList.add("tab-active","text-indigo-600"),e.classList.remove("tab-inactive","text-gray-500"),Array.from(d.children).forEach(e=>{e.id.endsWith(t)?e.classList.remove("hidden"):e.classList.add("hidden")})})})};S("input-tabs"),S("output-tabs"),document.querySelectorAll(".faq-question").forEach(e=>{e.addEventListener("click",()=>{const t=e.nextElementSibling,n=e.parentElement.classList.contains("open");document.querySelectorAll(".faq-item").forEach(t=>{t!==e.parentElement&&(t.classList.remove("open"),t.querySelector(".faq-answer").style.maxHeight=null,t.querySelector(".faq-icon-plus").classList.remove("hidden"),t.querySelector(".faq-icon-minus").classList.add("hidden"))}),n?(e.parentElement.classList.remove("open"),t.style.maxHeight=null,e.querySelector(".faq-icon-plus").classList.remove("hidden"),e.querySelector(".faq-icon-minus").classList.add("hidden")):(e.parentElement.classList.add("open"),t.style.maxHeight=t.scrollHeight+"px",e.querySelector(".faq-icon-plus").classList.add("hidden"),e.querySelector(".faq-icon-minus").classList.remove("hidden"))})}),I()});