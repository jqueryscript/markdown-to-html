document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("markdown-input"),t=document.getElementById("html-preview"),n=document.getElementById("html-code"),a=document.getElementById("remove-emojis"),d=document.getElementById("add-heading-ids"),s=document.getElementById("add-rel-to-links"),r=document.getElementById("sanitize-html"),o=document.getElementById("drop-area"),i=document.getElementById("file-upload"),l=document.getElementById("copy-html"),c=document.getElementById("download-html"),m=document.getElementById("sidebar"),u=document.getElementById("menu-button"),g=document.getElementById("sidebar-overlay"),h=()=>{m.classList.toggle("-translate-x-full"),g.classList.toggle("hidden")};u&&u.addEventListener("click",h),g&&g.addEventListener("click",h);const y=new marked.Renderer;y.heading=(e,t,n)=>{const a=e.text,s=e.depth;let r=a.toLowerCase().trim().replace(/[^\p{L}\p{N}]+/gu,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,"");return r||(r=`section-${Math.random().toString(36).substring(2,9)}`),d.checked?`<h${s} id="${r}">${a}</h${s}>\n`:`<h${s}>${a}</h${s}>\n`},y.link=(e,t,n)=>{const a=e.href,d=e.title,r=e.text;let o=`<a href="${a}"`;return d&&(o+=` title="${d}"`),s.checked&&(o+=' rel="noopener noreferrer"'),o+=`>${r}</a>`,o};const p=new marked.Marked({renderer:y,pedantic:!1,gfm:!0,breaks:!0,sanitize:!1,smartLists:!0,smartypants:!1,xhtml:!1}),v=()=>{let d=e.value||"";d=d.replace(/^\s*â€¢/gm,"-").replace(/^\s*:/gm,"-"),a.checked&&(d=d.replace(/\u00a9|\u00ae|[\u2000-\u3300]|\ud83c[\ud000-\udfff]|\ud83d[\ud000-\udfff]|\ud83e[\ud000-\udfff]/g,""));let s=p.parse(d);r.checked&&(s=DOMPurify.sanitize(s)),t.innerHTML=s,n.textContent=s};e.addEventListener("input",v),a.addEventListener("change",v),d.addEventListener("change",v),s.addEventListener("change",v),r.addEventListener("change",v),c.addEventListener("click",()=>{const e=`<!DOCTYPE html>\n<html lang="en">\n<head>\n  <meta charset="UTF-8">\n  <title>Exported Content</title>\n  <style>\nbody { font-family: sans-serif; }\n   </style>\n</head>\n<body>\n${t.innerHTML}\n</body>\n</html>`,n=new Blob([e],{type:"text/html"}),a=document.createElement("a");a.href=URL.createObjectURL(n),a.download="markdown-export.html",document.body.appendChild(a),a.click(),document.body.removeChild(a)});const E=t=>{const n=t[0];if(n&&n.name.endsWith(".md")){const t=new FileReader;t.onload=t=>{e.value=t.target.result,v(),document.querySelector('#input-tabs button[data-tab="markdown"]').click()},t.readAsText(n)}};o.addEventListener("dragenter",e=>{e.preventDefault(),o.classList.add("bg-gray-200")}),o.addEventListener("dragover",e=>{e.preventDefault()}),o.addEventListener("dragleave",()=>{o.classList.remove("bg-gray-200")}),o.addEventListener("drop",e=>{e.preventDefault(),o.classList.remove("bg-gray-200"),E(e.dataTransfer.files)}),o.addEventListener("click",()=>i.click()),i.addEventListener("change",e=>{E(e.target.files)}),l.addEventListener("click",()=>{navigator.clipboard.writeText(n.textContent).then(()=>{Toastify({text:"HTML code copied!",duration:3e3,gravity:"bottom",position:"center",style:{background:"#4f46e5"}}).showToast()},()=>{Toastify({text:"Failed to copy.",duration:3e3,gravity:"bottom",position:"center",style:{background:"#ef4444"}}).showToast()})}),n.addEventListener("keydown",e=>{if((e.ctrlKey||e.metaKey)&&"a"===e.key){e.preventDefault();const t=document.createRange();t.selectNodeContents(n);const a=window.getSelection();a.removeAllRanges(),a.addRange(t)}});const L=e=>{const t=document.getElementById(e),n=t.querySelectorAll(".tab-btn"),a=t.parentElement.nextElementSibling;n.forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.tab;n.forEach(e=>{e.classList.remove("tab-active","text-indigo-600"),e.classList.add("tab-inactive","text-gray-500")}),e.classList.add("tab-active","text-indigo-600"),e.classList.remove("tab-inactive","text-gray-500"),Array.from(a.children).forEach(e=>{e.id.endsWith(t)?e.classList.remove("hidden"):e.classList.add("hidden")})})})};L("input-tabs"),L("output-tabs"),document.querySelectorAll(".faq-question").forEach(e=>{e.addEventListener("click",()=>{const t=e.nextElementSibling,n=e.parentElement.classList.contains("open");document.querySelectorAll(".faq-item").forEach(t=>{t!==e.parentElement&&(t.classList.remove("open"),t.querySelector(".faq-answer").style.maxHeight=null,t.querySelector(".faq-icon-plus").classList.remove("hidden"),t.querySelector(".faq-icon-minus").classList.add("hidden"))}),n?(e.parentElement.classList.remove("open"),t.style.maxHeight=null,e.querySelector(".faq-icon-plus").classList.remove("hidden"),e.querySelector(".faq-icon-minus").classList.add("hidden")):(e.parentElement.classList.add("open"),t.style.maxHeight=t.scrollHeight+"px",e.querySelector(".faq-icon-plus").classList.add("hidden"),e.querySelector(".faq-icon-minus").classList.remove("hidden"))})}),v()});